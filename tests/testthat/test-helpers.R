test_that("location strings properly normalized", {
  locations <- c(
    "467" = "467..467",
    "340..565" = "340..565",
    "<345..500" = "345..500", 
    "complement(<345..500)" = "345..500",
    "join(11..22,<345..500)" = "11..22,345..500",
    "<1..888" = "1..888",
    "1..>888" = "1..888",
    "<1..>321" = "1..321",
    "complement(<1..>321)" = "1..321",
    "complement(1..>888)" = "1..888",
    "join(11..22,1..>888)" = "11..22,1..888",
    "102.110" = "102..110",
    "complement(102.110)" = "102..110",
    "join(11..22,102.110)" = "11..22,102..110",
    "123^124" = "123..124",
    "join(12..78,134..202)" = "12..78,134..202",
    "complement(34..126)" = "34..126",
    "complement(join(2691..4571,4918..5163))" = "2691..4571,4918..5163",
    "join(complement(4918..5163),complement(2691..4571))" = "4918..5163,2691..4571",
    "J00194.1:100..202" = "J00194.1:100..202",
    "J00194.1:100" = "J00194.1:100..100",
    "complement(J00194.1:100..202)" = "J00194.1:100..202",
    "join(1..100,J00194.1:100..202)" = "1..100,J00194.1:100..202",
    "complement(join(104366..104391,104932..105163," = "104366..104391,104932..105163,"
  )
  for (location in names(locations)) {
    normLocation <- normalizeLocation(location)
    expect_match(locations[location], normLocation)
  }
})
